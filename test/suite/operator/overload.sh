. test/assert.sh

hint 'operator/overload'

# Operator Overloading
pass '("()<-" "OP" "") ("OP")' '?'
pass '("()<-" "SQ" "(\"x<-\" \"#\" (\"@\")) (\"*\" (\"x->\" \"#\") (\"x->\" \"#\"))") ("SQ" #10#)' '#100#'
fail '("()<-" "SQ" "(\"x<-\" \"#\" (\"@\")) (\"*\" (\"x->\" \"#\") (\"x->\" \"#\"))") ("~" "(\"SQ\" #10#)" ?)' '#4#'
fail '("()<-" "SQ" "(\"x<-\" \"#\" (\"@\")) (\"*\" (\"x->\" \"#\") (\"x->\" \"#\"))") ("()<-" "DO" "(\"SQ\" #10#)") ("DO" ?)' '#4#'
pass '("()<-" "OP" "\"first\"") ("()<-" "OP" "\"last\"") ("OP" ?)' '"last"'
pass '("()<-" "!" "(\"+\" (\"@\") \"!!!\")") ("!" "hello")' '"hello!!!"'
pass '("()<-" "OP" "#123#") ("OP" ?)' '#123#'
pass '("()<-" "OP" "#123#") ("OP" ?) ("OP" ?) ("OP" ?)' '#123#'

# Literal Evaluation
pass '("()<-" "OP" "?") ("OP" ?)' '?'
pass '("()<-" "OP" "#100#") ("OP" ?)' '#100#'
pass '("()<-" "OP" "\"word\"") ("OP" ?)' '"word"'
pass '("()<-" "OP" "[#1# #2# #3#]") ("OP" ?)' '[#1# #2# #3#]'
pass '("()<-" "OP" "{\"key\" \"value\"}") ("OP" ?)' '{"key" "value"}'
pass '("()<-" "OP" "(\"#\" \"1\")") ("OP" ?)' '#1#'

# Variable Persistence
pass '("()<-" "OP" "(\"x<-\" \"local\" \"word\")") ("OP" ?) ("x->" "local")' '?'
pass '("()<-" "OP" "(\"x<-\" \"local\" \"after\")") ("x<-" "local" "before") ("OP" ?) ("x->" "local")' '"before"'

# Argument Passthrough
pass '("()<-" "OP" "") ("OP" ?) ("x->" "@")' '?'
pass '("()<-" "OP" "") ("OP" #100#) ("x->" "@")' '?'
pass '("()<-" "OP" "") ("OP" "word") ("x->" "@")' '?'
pass '("()<-" "OP" "") ("OP" [#1# #2# #3#]) ("x->" "@")' '?'
pass '("()<-" "OP" "") ("OP" {"key" "value"}) ("x->" "@")' '?'
pass '("()<-" "OP" "(\"@\")") ("OP" ?)' '?'
pass '("()<-" "OP" "(\"@\")") ("OP" #100#)' '#100#'
pass '("()<-" "OP" "(\"@\")") ("OP" "word")' '"word"'
pass '("()<-" "OP" "(\"@\")") ("OP" [#1# #2# #3#])' '[#1# #2# #3#]'
pass '("()<-" "OP" "(\"@\")") ("OP" {"key" "value"})' '{"key" "value"}'
pass '("()<-" "OP" "") ("x<-" "@" "before") ("OP" "after") ("x->" "@")' '"before"'
pass '("()<-" "OP" "(\"x<-\" \"@\" \"lastly\")") ("x<-" "@" "before") ("OP" "after") ("x->" "@")' '"before"'
pass '("()<-" "OP" "") ("OP" ("<>" "ERROR"))' '?'
fail '("()<-" "OP" "(\"@\")") ("OP" ("<>" "ERROR"))' '"ERROR"'

# Argument Error
fail '("()<-")' '#4#'
fail '("()<-" ?)' '#4#'
fail '("()<-" ? ?)' '#4#'
fail '("()<-" ? ##)' '#4#'
fail '("()<-" ? "")' '#4#'
fail '("()<-" ? [])' '#4#'
fail '("()<-" ? {})' '#4#'
fail '("()<-" ##)' '#4#'
fail '("()<-" ## ?)' '#4#'
fail '("()<-" ## ##)' '#4#'
fail '("()<-" ## "")' '#4#'
fail '("()<-" ## [])' '#4#'
fail '("()<-" ## {})' '#4#'
fail '("()<-" "")' '#4#'
fail '("()<-" [])' '#4#'
fail '("()<-" [] ?)' '#4#'
fail '("()<-" [] ##)' '#4#'
fail '("()<-" [] "")' '#4#'
fail '("()<-" [] [])' '#4#'
fail '("()<-" [] {})' '#4#'
fail '("()<-" {})' '#4#'
fail '("()<-" {} ?)' '#4#'
fail '("()<-" {} ##)' '#4#'
fail '("()<-" {} "")' '#4#'
fail '("()<-" {} [])' '#4#'
fail '("()<-" {} {})' '#4#'

# Error Propogation
fail '("()<-" ("<>" "ERROR") "(\"#\" \"100\")")' '"ERROR"'
fail '("()<-" "OP" ("<>" "ERROR"))' '"ERROR"'
